{"version":3,"file":"rollup-plugin-babili.es2015.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["'use strict';\n\nfunction filterBabiliOptions( options ) {\n\tconst disallowedProperties = [\n\t\t'banner',\n\t\t'sourceMap',\n\t\t'comments'\n\t];\n\tconst babiliOptions = {};\n\n\tObject.keys( options ).filter( ( option ) => {\n\t\tif ( disallowedProperties.indexOf( option ) === -1 ) {\n\t\t\tbabiliOptions[ option ] = options[ option ];\n\t\t}\n\t} );\n\n\treturn babiliOptions;\n}\n\nfunction isString( v ) {\n\treturn v != null && typeof v === 'string';\n}\n\nfunction isFn( v ) {\n\treturn v != null && typeof v === 'function';\n}\n\nfunction isFnOrString( v ) {\n\treturn isString( v ) || isFn( v );\n}\n\nexport { filterBabiliOptions };\nexport { isString };\nexport { isFn };\nexport { isFnOrString };\n","'use strict';\n\nimport { filterBabiliOptions } from './utils.js';\nimport { isFn } from './utils.js';\nimport { isFnOrString } from './utils.js';\nimport babiliPreset from 'babel-preset-babili';\nimport bannerPlugin from '@comandeer/babel-plugin-banner';\nimport { getCommentContent } from '@comandeer/babel-plugin-banner/utils';\nimport { transform } from 'babel-core';\n\nfunction babili( options = {} ) {\n\tlet rollupBanner;\n\n\treturn {\n\t\tname: 'babili',\n\n\t\toptions( { banner } ) {\n\t\t\trollupBanner = banner;\n\t\t},\n\n\t\ttransformBundle( bundle ) {\n\t\t\tconst babiliOptions = filterBabiliOptions( options );\n\t\t\tconst babelConf = {\n\t\t\t\tpresets: [ [ babiliPreset, babiliOptions ] ],\n\t\t\t\tsourceMaps: typeof options.sourceMap !== 'undefined' ? Boolean( options.sourceMap ) : true,\n\t\t\t\tcomments: typeof options.comments !== 'undefined' ? Boolean( options.comments ) : true\n\t\t\t};\n\n\t\t\tif ( isFnOrString( options.banner ) || isFnOrString ( rollupBanner ) ) {\n\t\t\t\tlet banner = options.banner || rollupBanner;\n\t\t\t\tbanner = isFn ( banner ) ? banner() : banner;\n\t\t\t\tconst bannerContent = getCommentContent( banner );\n\t\t\t\tlet isAlreadyInserted = false;\n\n\t\t\t\tbabelConf.plugins = [\n\t\t\t\t\t[ bannerPlugin, {\n\t\t\t\t\t\tbanner\n\t\t\t\t\t} ]\n\t\t\t\t];\n\n\t\t\t\tif ( !babelConf.comments ) {\n\t\t\t\t\tbabelConf.shouldPrintComment = ( comment ) => {\n\t\t\t\t\t\tif ( !isAlreadyInserted && comment === bannerContent ) {\n\t\t\t\t\t\t\tisAlreadyInserted = true;\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst { code, map } = transform( bundle, babelConf );\n\n\t\t\treturn {\n\t\t\t\tcode,\n\t\t\t\tmap\n\t\t\t};\n\t\t}\n\t};\n}\n\nexport default babili;\n"],"names":["filterBabiliOptions","Object","keys","options","filter","indexOf","option","babiliOptions","isString","v","isFn","isFnOrString","babili","name","banner","transformBundle","presets","babiliPreset","sourceMaps","sourceMap","comments","rollupBanner","getCommentContent","babelConf","plugins","bannerPlugin","shouldPrintComment","isAlreadyInserted","comment","bannerContent","code","map","transform","bundle"],"mappings":"gSAEA,QAASA,oBAAT,GAAwC,CACvC,KAAM,oCAAN,CAKM,IALN,CAaA,MANAC,QAAOC,IAAP,CAAaC,CAAb,EAAuBC,MAAvB,CAA+B,KAAc,CACI,CAAC,CAA5C,KAAqBC,OAArB,CAA8BC,CAA9B,CADuC,GAE3CC,EAAeD,CAAf,EAA0BH,EAASG,CAAT,CAFiB,CAI5C,CAJD,CAMA,CAAOC,CACP,CAED,QAASC,SAAT,GAAuB,CACtB,MAAY,KAAL,KAA0B,QAAb,QAAOC,EAC3B,CAED,QAASC,KAAT,GAAmB,CAClB,MAAY,KAAL,KAA0B,UAAb,QAAOD,EAC3B,CAED,QAASE,aAAT,GAA2B,CAC1B,MAAOH,UAAUC,CAAV,GAAiBC,KAAMD,CAAN,CACxB,CCnBD,QAASG,OAAT,CAAiB,IAAjB,CAAgC,CAC/B,GAAI,EAAJ,CAEA,MAAO,CACNC,KAAM,QADA,CAGNV,QAAS,CAAEW,QAAF,CAAT,CAAsB,CACrB,EAAeA,CACf,CALK,CAONC,kBAA0B,CACzB,KAAM,GAAgBf,oBAAqBG,CAArB,CAAtB,CACM,EAAY,CACjBa,QAAS,CAAE,CAAEC,YAAF,CAAgBV,CAAhB,CAAF,CADQ,CAEjBW,aAAyC,WAA7B,QAAOf,GAAQgB,SAA3B,KAAgEhB,EAAQgB,SAFvD,CAGjBC,WAAsC,WAA5B,QAAOjB,GAAQiB,QAAzB,KAA6DjB,EAAQiB,QAHpD,CADlB,CAOA,GAAKT,aAAcR,EAAQW,MAAtB,GAAkCH,aAAeU,CAAf,CAAvC,CAAuE,CACtE,GAAI,GAASlB,EAAQW,MAAR,EAAkBO,CAA/B,CACA,EAASX,KAAOI,CAAP,EAAkBA,GAAlB,CAA6BA,CAFgC,CAGtE,KAAM,GAAgBQ,kBAAmBR,CAAnB,CAAtB,CACA,GAAI,KAAJ,CAEAS,EAAUC,OAAV,CAAoB,CACnB,CAAEC,YAAF,CAAgB,CACfX,QADe,CAAhB,CADmB,CANkD,CAYhES,EAAUH,QAZsD,GAarEG,EAAUG,kBAAV,CAA+B,KAAe,OACvCC,EAAD,EAAsBC,IAAYC,CADM,KAE5C,IAF4C,IAQ7C,CArBoE,CAuBtE,CAED,KAAM,CAAEC,MAAF,CAAQC,KAAR,EAAgBC,UAAWC,CAAX,CAAmBV,CAAnB,CAAtB,CAEA,MAAO,CACNO,MADM,CAENC,KAFM,CAIP,CA9CK,CAgDP"}